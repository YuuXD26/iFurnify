const _0x153034=_0x2b72;(function(_0x2026bb,_0x5aa463){const _0x35ef99=_0x2b72,_0x216d3f=_0x2026bb();while(!![]){try{const _0x2c9e58=parseInt(_0x35ef99(0x101))/0x1*(-parseInt(_0x35ef99(0x108))/0x2)+parseInt(_0x35ef99(0x118))/0x3+parseInt(_0x35ef99(0x11b))/0x4*(-parseInt(_0x35ef99(0x119))/0x5)+parseInt(_0x35ef99(0x130))/0x6+parseInt(_0x35ef99(0x141))/0x7*(-parseInt(_0x35ef99(0x151))/0x8)+-parseInt(_0x35ef99(0x10d))/0x9+-parseInt(_0x35ef99(0xfb))/0xa*(-parseInt(_0x35ef99(0x14b))/0xb);if(_0x2c9e58===_0x5aa463)break;else _0x216d3f['push'](_0x216d3f['shift']());}catch(_0x54545d){_0x216d3f['push'](_0x216d3f['shift']());}}}(_0x21cb,0x92905),require(_0x153034(0x104))[_0x153034(0x120)]());const express=require('express'),bodyParser=require(_0x153034(0x147)),mongoose=require(_0x153034(0x11e)),bcrypt=require(_0x153034(0x143)),fs=require('fs'),session=require('express-session'),app=express();function _0x2b72(_0x2522db,_0x2f88bb){const _0x21cbae=_0x21cb();return _0x2b72=function(_0x2b7280,_0x423905){_0x2b7280=_0x2b7280-0xfa;let _0x2728a1=_0x21cbae[_0x2b7280];return _0x2728a1;},_0x2b72(_0x2522db,_0x2f88bb);}app[_0x153034(0x153)](bodyParser[_0x153034(0x135)]()),app[_0x153034(0x153)](express[_0x153034(0x114)]('view')),app['use'](bodyParser[_0x153034(0x12f)]({'extended':!![]})),app[_0x153034(0x153)](session({'secret':_0x153034(0x132),'resave':![],'saveUninitialized':!![]})),mongoose[_0x153034(0x12a)](process['env']['MONGODB_URL'],{'useNewUrlParser':!![],'useUnifiedTopology':!![]});const db=mongoose[_0x153034(0xfd)];function _0x21cb(){const _0x5cc8cd=['/sign_out','Pengguna\x20tidak\x20ditemukan','Error\x20saat\x20mengubah\x20profil\x20pengguna:','status','1004976pDLFQo','Keranjang\x20tidak\x20ditemukan','post','/get_cart_data','itemPrice','itemName','/login.html','static','Error\x20saat\x20mengambil\x20data\x20pengguna:','/logout','Login\x20berhasil','162942plBcNA','10UlNyyY','redirect','1340204FYjyqH','Connected\x20to\x20Database','parse','mongoose','collection','config','email','/sign_up','Informasi\x20tidak\x20valid','send','tab.html','get','readFileSync','users','Error\x20saat\x20memeriksa\x20email:','connect','findOne','userEmail','Error\x20Server\x20Internal','phoneNumber','urlencoded','817104CxjoJn','cart','wagir','location','/add_to_cart','json','open','Item\x20tidak\x20ditemukan\x20dalam\x20keranjang','Listening\x20on\x20PORT\x203000','name','Internal\x20Server\x20Error','Record\x20Inserted\x20Successfully','Email\x20diperlukan','Anda\x20belum\x20login','insertOne','/check_email','once','7ilukIn','log','bcrypt','hash','password','writeFileSync','body-parser','updateOne','Error\x20reading\x20cart.json:','/edit_profile','22fAuxix','listen','Password\x20is\x20required','Email\x20tersedia','/sign_in','Password\x20salah','4476376ntembg','findIndex','use','destroy','10922940dCHerB','utf8','connection','stringify','session','cart.json','4oMaVmt','Error\x20hashing\x20password:','Logout\x20berhasil','dotenv','body','error','Email\x20sudah\x20digunakan','216724eKjErh'];_0x21cb=function(){return _0x5cc8cd;};return _0x21cb();}db['on'](_0x153034(0x106),()=>console[_0x153034(0x142)]('Error\x20in\x20Connecting\x20to\x20Database')),db[_0x153034(0x140)](_0x153034(0x136),()=>console[_0x153034(0x142)](_0x153034(0x11c)));let cartData={};try{cartData=JSON[_0x153034(0x11d)](fs[_0x153034(0x127)](_0x153034(0x100),_0x153034(0xfc)));}catch(_0x556a3d){console[_0x153034(0x106)](_0x153034(0x149),_0x556a3d);}const checkAuth=(_0x4c3f91,_0x4571b0,_0x2ddb11)=>{const _0x4ef860=_0x153034;_0x4c3f91[_0x4ef860(0xff)][_0x4ef860(0x12c)]?_0x2ddb11():_0x4571b0[_0x4ef860(0x10c)](0x191)[_0x4ef860(0x135)]({'error':_0x4ef860(0x13d)});};app[_0x153034(0x10f)](_0x153034(0x122),async(_0x28af18,_0x39eff9)=>{const _0x2a04c5=_0x153034,_0x158c43=_0x28af18['body'][_0x2a04c5(0x139)],_0xb5206f=_0x28af18[_0x2a04c5(0x105)]['email'],_0x13872e=_0x28af18['body'][_0x2a04c5(0x145)];if(!_0x13872e)return _0x39eff9[_0x2a04c5(0x10c)](0x190)[_0x2a04c5(0x135)]({'error':_0x2a04c5(0x14d)});try{const _0x4bb5a4=await bcrypt[_0x2a04c5(0x144)](_0x13872e,0xa),_0x5a179a={'name':_0x158c43,'email':_0xb5206f,'password':_0x4bb5a4};return db[_0x2a04c5(0x11f)](_0x2a04c5(0x128))[_0x2a04c5(0x13e)](_0x5a179a,(_0x3933c9,_0x22fdf3)=>{const _0x268598=_0x2a04c5;if(_0x3933c9)throw _0x3933c9;console['log'](_0x268598(0x13b));}),cartData[_0xb5206f]={'email':_0xb5206f,'cart':[]},fs[_0x2a04c5(0x146)](_0x2a04c5(0x100),JSON[_0x2a04c5(0xfe)](cartData,null,0x2)),_0x28af18['session'][_0x2a04c5(0x12c)]=_0xb5206f,_0x39eff9['redirect']('login.html');}catch(_0x538033){return console['error'](_0x2a04c5(0x102),_0x538033),_0x39eff9[_0x2a04c5(0x10c)](0x1f4)[_0x2a04c5(0x135)]({'error':_0x2a04c5(0x13a)});}}),app['post'](_0x153034(0x14f),async(_0xb9a236,_0x53f98f)=>{const _0x5ae58d=_0x153034;try{const _0x5643a0=_0xb9a236['body']['email'],_0x1fa81e=_0xb9a236[_0x5ae58d(0x105)][_0x5ae58d(0x145)],_0x59fb4a=await db[_0x5ae58d(0x11f)](_0x5ae58d(0x128))[_0x5ae58d(0x12b)]({'email':_0x5643a0});if(!_0x59fb4a)return _0x53f98f[_0x5ae58d(0x10c)](0x194)[_0x5ae58d(0x124)](_0x5ae58d(0x123));const _0x32cfeb=await bcrypt['compare'](_0x1fa81e,_0x59fb4a['password']);if(_0x32cfeb)console[_0x5ae58d(0x142)](_0x5ae58d(0x117)),_0xb9a236[_0x5ae58d(0xff)][_0x5ae58d(0x12c)]=_0x5643a0,_0x53f98f[_0x5ae58d(0x11a)](_0x5ae58d(0x125));else return console['log'](_0x5ae58d(0x150)),_0x53f98f[_0x5ae58d(0x10c)](0x191)[_0x5ae58d(0x124)](_0x5ae58d(0x150));}catch(_0x45fcd9){return console[_0x5ae58d(0x106)]('Error\x20selama\x20login:',_0x45fcd9),_0x53f98f['status'](0x1f4)[_0x5ae58d(0x135)]({'error':'Error\x20Server\x20Internal'});}}),app['post'](_0x153034(0x109),(_0x22ba5f,_0x4b00ff)=>{const _0x10667d=_0x153034;_0x22ba5f['session'][_0x10667d(0xfa)](_0x23d695=>{const _0x28d5d0=_0x10667d;if(_0x23d695)return console['error']('Error\x20saat\x20logout:',_0x23d695),_0x4b00ff[_0x28d5d0(0x10c)](0x1f4)[_0x28d5d0(0x135)]({'error':'Error\x20Server\x20Internal'});_0x4b00ff[_0x28d5d0(0x10c)](0xc8)[_0x28d5d0(0x135)]({'message':_0x28d5d0(0x103)});});}),app[_0x153034(0x126)]('/get_logged_in_user',checkAuth,(_0x465a5a,_0xfaa027)=>{const _0x215859=_0x153034;_0xfaa027[_0x215859(0x10c)](0xc8)['json']({'email':_0x465a5a['session'][_0x215859(0x12c)]});}),app[_0x153034(0x126)]('/get_user_data',checkAuth,async(_0x21aae1,_0x235aae)=>{const _0x203331=_0x153034,_0x586205=_0x21aae1[_0x203331(0xff)][_0x203331(0x12c)];try{const _0x6cc502=await db[_0x203331(0x11f)](_0x203331(0x128))['findOne']({'email':_0x586205});if(!_0x6cc502)return _0x235aae[_0x203331(0x10c)](0x194)[_0x203331(0x135)]({'error':_0x203331(0x10a)});const _0x554e71={'name':_0x6cc502[_0x203331(0x139)],'email':_0x6cc502[_0x203331(0x121)],'location':_0x6cc502[_0x203331(0x133)]||'','phoneNumber':_0x6cc502[_0x203331(0x12e)]||''};_0x235aae[_0x203331(0x10c)](0xc8)['json'](_0x554e71);}catch(_0x13c145){return console[_0x203331(0x106)](_0x203331(0x115),_0x13c145),_0x235aae[_0x203331(0x10c)](0x1f4)['json']({'error':_0x203331(0x12d)});}}),app[_0x153034(0x10f)](_0x153034(0x13f),(_0x4c751f,_0x5deb52)=>{const _0x4515bb=_0x153034,_0xa39e1d=_0x4c751f[_0x4515bb(0x105)][_0x4515bb(0x121)];db[_0x4515bb(0x11f)](_0x4515bb(0x128))[_0x4515bb(0x12b)]({'email':_0xa39e1d},(_0x2b8248,_0x4d2b46)=>{const _0x1e5ef5=_0x4515bb;if(_0x2b8248)return console[_0x1e5ef5(0x106)](_0x1e5ef5(0x129),_0x2b8248),_0x5deb52[_0x1e5ef5(0x10c)](0x1f4)[_0x1e5ef5(0x135)]({'error':_0x1e5ef5(0x13a)});if(_0x4d2b46)return _0x5deb52[_0x1e5ef5(0x10c)](0x190)['json']({'error':_0x1e5ef5(0x107)});return _0x5deb52[_0x1e5ef5(0x10c)](0xc8)[_0x1e5ef5(0x135)]({'message':_0x1e5ef5(0x14e)});});}),app[_0x153034(0x126)](_0x153034(0x116),(_0xe54daa,_0x17c7dd)=>{const _0x4ba195=_0x153034;_0xe54daa[_0x4ba195(0xff)][_0x4ba195(0xfa)](_0x24c841=>{const _0x22473c=_0x4ba195;if(_0x24c841)return console['error']('Error\x20saat\x20logout:',_0x24c841),_0x17c7dd[_0x22473c(0x10c)](0x1f4)[_0x22473c(0x135)]({'error':_0x22473c(0x13a)});_0x17c7dd[_0x22473c(0x11a)](_0x22473c(0x113));});}),app[_0x153034(0x10f)](_0x153034(0x14a),checkAuth,async(_0x540344,_0x259588)=>{const _0x71cd9c=_0x153034,_0x509699=_0x540344['session'][_0x71cd9c(0x12c)],_0x2f21e9=_0x540344['body'][_0x71cd9c(0x139)],_0x5dc28b=_0x540344[_0x71cd9c(0x105)]['email'],_0x38b80a=_0x540344[_0x71cd9c(0x105)][_0x71cd9c(0x133)],_0x5b8abb=_0x540344[_0x71cd9c(0x105)][_0x71cd9c(0x12e)];try{const _0x570450=await db['collection']('users')['findOne']({'email':_0x509699});if(!_0x570450)return _0x259588[_0x71cd9c(0x10c)](0x194)[_0x71cd9c(0x135)]({'error':_0x71cd9c(0x10a)});_0x570450['name']=_0x2f21e9,_0x570450['email']=_0x5dc28b,_0x570450[_0x71cd9c(0x133)]=_0x38b80a||'',_0x570450[_0x71cd9c(0x12e)]=_0x5b8abb||'',await db[_0x71cd9c(0x11f)](_0x71cd9c(0x128))[_0x71cd9c(0x148)]({'email':_0x509699},{'$set':_0x570450});if(cartData[_0x509699]){const _0x5c1c3e={...cartData};_0x5c1c3e[_0x5dc28b]=_0x5c1c3e[_0x509699],delete _0x5c1c3e[_0x509699],fs[_0x71cd9c(0x146)](_0x71cd9c(0x100),JSON[_0x71cd9c(0xfe)](_0x5c1c3e,null,0x2));}}catch(_0x46722a){return console[_0x71cd9c(0x106)](_0x71cd9c(0x10b),_0x46722a),_0x259588[_0x71cd9c(0x10c)](0x1f4)[_0x71cd9c(0x135)]({'error':_0x71cd9c(0x12d)});}}),app[_0x153034(0x10f)](_0x153034(0x134),checkAuth,(_0x3bee70,_0x586ac7)=>{const _0x2a9f9e=_0x153034,_0x14a9be=_0x3bee70[_0x2a9f9e(0xff)][_0x2a9f9e(0x12c)],_0x4edfa2=_0x3bee70[_0x2a9f9e(0x105)][_0x2a9f9e(0x112)],_0x286f16=_0x3bee70['body'][_0x2a9f9e(0x111)];if(!_0x14a9be)return _0x586ac7[_0x2a9f9e(0x10c)](0x190)[_0x2a9f9e(0x135)]({'error':_0x2a9f9e(0x13c)});!cartData[_0x14a9be]&&(cartData[_0x14a9be]={'email':_0x14a9be,'cart':[]}),cartData[_0x14a9be]['cart']['push']({'name':_0x4edfa2,'price':_0x286f16}),fs[_0x2a9f9e(0x146)](_0x2a9f9e(0x100),JSON[_0x2a9f9e(0xfe)](cartData,null,0x2)),_0x586ac7[_0x2a9f9e(0x10c)](0xc8)[_0x2a9f9e(0x135)]({'message':'Item\x20berhasil\x20ditambahkan\x20ke\x20keranjang'});}),app[_0x153034(0x10f)]('/remove_from_cart',checkAuth,(_0x1cc043,_0x485d65)=>{const _0x233efb=_0x153034,_0x467517=_0x1cc043[_0x233efb(0xff)]['userEmail'],_0x19935e=_0x1cc043[_0x233efb(0x105)]['itemName'];if(!_0x467517)return _0x485d65[_0x233efb(0x10c)](0x190)[_0x233efb(0x135)]({'error':'Email\x20diperlukan'});if(!cartData[_0x467517])return _0x485d65[_0x233efb(0x10c)](0x190)[_0x233efb(0x135)]({'error':_0x233efb(0x10e)});const _0x345d8f=cartData[_0x467517][_0x233efb(0x131)][_0x233efb(0x152)](_0x367d1c=>_0x367d1c[_0x233efb(0x139)]===_0x19935e);_0x345d8f!==-0x1?(cartData[_0x467517][_0x233efb(0x131)]['splice'](_0x345d8f,0x1),fs['writeFileSync'](_0x233efb(0x100),JSON[_0x233efb(0xfe)](cartData,null,0x2)),_0x485d65['status'](0xc8)['json']({'message':'Item\x20berhasil\x20dihapus\x20dari\x20keranjang'})):_0x485d65[_0x233efb(0x10c)](0x194)[_0x233efb(0x135)]({'error':_0x233efb(0x137)});}),app[_0x153034(0x126)](_0x153034(0x110),checkAuth,(_0x55616a,_0x521c2d)=>{const _0x33f24a=_0x153034,_0x1778ba=_0x55616a[_0x33f24a(0xff)][_0x33f24a(0x12c)];if(!_0x1778ba)return _0x521c2d['status'](0x190)[_0x33f24a(0x135)]({'error':_0x33f24a(0x13c)});if(!cartData[_0x1778ba])return _0x521c2d['status'](0x190)['json']({'error':'Keranjang\x20tidak\x20ditemukan'});_0x521c2d[_0x33f24a(0x10c)](0xc8)[_0x33f24a(0x135)](cartData[_0x1778ba]);}),app[_0x153034(0x14c)](0xbb8,()=>{const _0x1b19ec=_0x153034;console[_0x1b19ec(0x142)](_0x1b19ec(0x138));});